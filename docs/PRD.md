# 소모임 통합 관리 웹앱 MVP PRD

**작성일**: 2026-02-22
**버전**: 1.0
**상태**: 작성 완료

---

## 목차

1. [개요](#1-개요)
2. [목표 및 대상 사용자](#2-목표-및-대상-사용자)
3. [핵심 기능 상세](#3-핵심-기능-상세)
4. [사용자 여정 (Happy Path)](#4-사용자-여정-happy-path)
5. [기술 요구사항](#5-기술-요구사항)
6. [성공 지표](#6-성공-지표)
7. [개발 로드맵](#7-개발-로드맵)

---

## 1. 개요

### 문제 정의

소규모 모임(5~20명) 주최자는 현재 다음 세 가지 도구를 병행해야 한다.

| 현재 도구         | 사용 목적                 | 문제점                                      |
| ----------------- | ------------------------- | ------------------------------------------- |
| 카카오톡 단톡방   | 공지 전달, 참여 의사 확인 | 메시지 유실, 응답 추적 불가, 카풀 신청 혼선 |
| 구글 스프레드시트 | 참여자 명단, 정산 내역    | 접근 권한 관리 번거로움, 모바일 편집 불편   |
| 개인 계좌 문자    | 계좌 안내, 입금 확인      | 수동 확인 반복, 실수 발생                   |

이 세 가지를 오가는 컨텍스트 스위칭이 주최자의 운영 부담을 높이고, 참여자 입장에서도 어디에서 무엇을 확인해야 하는지 명확하지 않다.

### 해결책

공지, 참여자 관리, 카풀 매칭, 정산 안내를 **하나의 웹 앱**에서 처리한다. 주최자가 모임을 생성하고 초대 링크를 단톡방에 공유하면, 참여자는 링크 하나로 모든 정보에 접근한다. 실제 결제는 기존 계좌이체를 유지하되, 금액 계산과 계좌 안내만 자동화한다.

---

## 2. 목표 및 대상 사용자

### 목표

- 주최자의 모임 운영 반복 작업(참여 확인, 정산 계산, 카풀 조율)을 30분 이상 단축
- 참여자가 별도 앱 설치 없이 초대 링크 하나로 모임 정보 확인 및 참여 신청 가능
- 수영, 헬스, 식사, 등산, 자전거, 테니스 등 다양한 정기 소모임에 범용 적용

### 대상 사용자

**주 사용자 - 모임 주최자**

- 정기적으로 5~20명 규모 소모임을 운영하는 일반인
- 현재 카카오톡 + 스프레드시트를 병행 사용 중
- 기술 친숙도: 보통 (스마트폰 앱 설치, 온라인 뱅킹 사용 가능)

**부 사용자 - 모임 참여자**

- 주최자가 공유한 초대 링크로 진입하는 모임 구성원
- 웹 브라우저만으로 참여 신청, 공지 확인, 카풀 신청, 정산 내역 확인

---

## 3. 핵심 기능 상세

### Phase 1: 공지 + 참여자 관리

#### 기능 명세

| ID       | 기능명         | 설명                                                                                          | 관련 페이지                            |
| -------- | -------------- | --------------------------------------------------------------------------------------------- | -------------------------------------- |
| **F001** | 모임 생성      | 제목, 카테고리, 날짜, 장소, 최대 인원, 계좌 정보를 입력해 모임 등록. 8자리 초대코드 자동 생성 | 모임 생성 페이지                       |
| **F002** | 내 이벤트 목록 | 내가 주최한 모임과 참여 중인 모임을 탭으로 구분해 표시. 모바일 최적화 디자인                  | 내 이벤트 페이지 (`/protected/events`) |
| **F003** | 모임 홈        | 핀 고정 공지, 기본 정보(날짜, 장소, 인원 현황), 초대 링크 복사 버튼 제공                      | 모임 홈 페이지                         |
| **F004** | 초대 링크 입장 | 비인증 사용자도 초대 링크 접근 가능. 로그인 후 자동으로 참여 신청 처리                        | 초대 링크 처리 페이지                  |
| **F005** | 참여 신청      | 참여자가 모임 참여를 신청. 메모(비고) 입력 가능                                               | 초대 링크 처리 페이지, 모임 홈 페이지  |
| **F006** | 참여자 관리    | 주최자가 신청자를 승인/거절/탈퇴 처리. 상태별(대기/승인/거절) 필터 조회                       | 참여자 관리 페이지                     |
| **F007** | 공지 작성      | 주최자가 제목, 내용을 입력해 공지 등록. 핀 고정 여부 선택 가능                                | 공지 작성 페이지                       |
| **F008** | 공지 목록      | 모임 참여자 전체가 공지 목록 조회. 핀 공지는 상단 고정                                        | 공지 목록 페이지                       |
| **F009** | 모임 마감      | 주최자가 신규 참여 신청을 마감. 마감 후 초대 링크로 신규 신청 불가                            | 참여자 관리 페이지, 모임 홈 페이지     |
| **F010** | 기본 인증      | 이메일/비밀번호, Google OAuth 로그인. 회원가입/로그인/로그아웃. (기존 구현 완료)              | 로그인 페이지, 회원가입 페이지         |

#### DB 스키마

**events 테이블**

| 필드         | 설명                                                         | 타입/관계     |
| ------------ | ------------------------------------------------------------ | ------------- |
| id           | 고유 식별자                                                  | UUID          |
| host_id      | 주최자                                                       | → profiles.id |
| title        | 모임 제목                                                    | text          |
| description  | 모임 설명                                                    | text          |
| category     | 카테고리 (swimming, gym, meal, hiking, cycling, tennis, etc) | text          |
| event_date   | 모임 날짜/시간                                               | timestamptz   |
| location     | 장소                                                         | text          |
| max_members  | 최대 인원                                                    | integer       |
| invite_code  | 초대코드 (8자리 고유값)                                      | text          |
| bank_account | 계좌 정보 (은행명, 계좌번호, 예금주)                         | jsonb         |
| is_closed    | 신청 마감 여부                                               | boolean       |
| created_at   | 생성일시                                                     | timestamptz   |

**event_members 테이블**

| 필드       | 설명                                             | 타입/관계     |
| ---------- | ------------------------------------------------ | ------------- |
| id         | 고유 식별자                                      | UUID          |
| event_id   | 모임                                             | → events.id   |
| user_id    | 참여자                                           | → profiles.id |
| status     | 상태 (pending / approved / rejected / withdrawn) | text          |
| memo       | 참여자 메모 (비고)                               | text          |
| created_at | 신청일시                                         | timestamptz   |

**announcements 테이블**

| 필드       | 설명         | 타입/관계     |
| ---------- | ------------ | ------------- |
| id         | 고유 식별자  | UUID          |
| event_id   | 모임         | → events.id   |
| author_id  | 작성자       | → profiles.id |
| title      | 공지 제목    | text          |
| content    | 공지 내용    | text          |
| is_pinned  | 핀 고정 여부 | boolean       |
| created_at | 작성일시     | timestamptz   |

---

### Phase 2: 카풀 + 정산

#### 기능 명세

| ID       | 기능명           | 설명                                                             | 관련 페이지 |
| -------- | ---------------- | ---------------------------------------------------------------- | ----------- |
| **F011** | 카풀 제공 등록   | 드라이버가 출발지, 출발 시각, 탑승 가능 인원을 등록              | 카풀 페이지 |
| **F012** | 카풀 신청        | 참여자가 원하는 카풀 제공 건을 선택해 탑승 신청                  | 카풀 페이지 |
| **F013** | 카풀 신청 관리   | 드라이버가 탑승 신청자를 수락/거절 처리                          | 카풀 페이지 |
| **F014** | 정산 항목 등록   | 주최자가 항목명, 총 금액, 분할 방식(1/n 균등 / 수동 입력)을 등록 | 정산 페이지 |
| **F015** | 개인별 정산 확인 | 참여자가 자신의 부담 금액과 입금 계좌를 확인                     | 정산 페이지 |
| **F016** | 입금 확인 처리   | 주최자가 각 참여자의 입금 완료 여부를 수동으로 체크              | 정산 페이지 |

#### DB 스키마

**carpool_offers 테이블**

| 필드               | 설명           | 타입/관계     |
| ------------------ | -------------- | ------------- |
| id                 | 고유 식별자    | UUID          |
| event_id           | 모임           | → events.id   |
| driver_id          | 드라이버       | → profiles.id |
| departure_location | 출발지         | text          |
| departure_time     | 출발 시각      | timestamptz   |
| available_seats    | 탑승 가능 인원 | integer       |
| created_at         | 등록일시       | timestamptz   |

**carpool_requests 테이블**

| 필드         | 설명                                 | 타입/관계           |
| ------------ | ------------------------------------ | ------------------- |
| id           | 고유 식별자                          | UUID                |
| offer_id     | 카풀 제공 건                         | → carpool_offers.id |
| passenger_id | 신청자                               | → profiles.id       |
| status       | 상태 (pending / accepted / rejected) | text                |
| created_at   | 신청일시                             | timestamptz         |

**expense_items 테이블**

| 필드         | 설명                       | 타입/관계     |
| ------------ | -------------------------- | ------------- |
| id           | 고유 식별자                | UUID          |
| event_id     | 모임                       | → events.id   |
| author_id    | 등록자                     | → profiles.id |
| item_name    | 항목명 (예: 장소 대관비)   | text          |
| total_amount | 총 금액                    | integer       |
| split_type   | 분할 방식 (equal / manual) | text          |
| created_at   | 등록일시                   | timestamptz   |

**expense_splits 테이블**

| 필드       | 설명           | 타입/관계          |
| ---------- | -------------- | ------------------ |
| id         | 고유 식별자    | UUID               |
| item_id    | 정산 항목      | → expense_items.id |
| user_id    | 대상 참여자    | → profiles.id      |
| amount     | 부담 금액      | integer            |
| is_paid    | 입금 확인 여부 | boolean            |
| created_at | 생성일시       | timestamptz        |

---

## 4. 사용자 여정 (Happy Path)

### 4-1. 주최자 여정

```
[랜딩 페이지]
  |
  | 로그인 버튼 클릭 (미인증 시 자동 리디렉션)
  v
[로그인 페이지] - 이메일/비밀번호 또는 Google OAuth
  |
  | 로그인 성공
  v
[모임 목록 페이지] - "내가 주최한 모임" 탭 기본 표시
  |
  | "새 모임 만들기" 버튼 클릭
  v
[모임 생성 페이지]
  - 제목, 카테고리, 날짜/시간, 장소, 최대 인원 입력
  - 계좌 정보(은행명, 계좌번호, 예금주) 입력
  - "모임 만들기" 버튼 클릭 → 초대코드 자동 생성
  |
  | 생성 완료
  v
[모임 홈 페이지]
  - 초대 링크 복사 버튼으로 단톡방에 공유
  - 핀 공지 영역 (초기: 비어있음)
  - 기본 정보 요약 표시
  |
  | "공지 쓰기" 버튼 클릭
  v
[공지 작성 페이지]
  - 제목, 내용 입력, 핀 고정 여부 선택
  - "등록" 버튼 클릭
  |
  | 공지 등록 완료
  v
[모임 홈 페이지] - 핀 공지 반영 확인
  |
  | "참여자" 탭 클릭
  v
[참여자 관리 페이지]
  - 대기 상태 참여자 승인/거절 처리
  - 전체 인원 현황 확인
  - "마감" 버튼으로 신규 신청 차단
```

### 4-2. 참여자 여정

```
[카카오톡에서 초대 링크 수신]
  |
  | 링크 클릭
  v
[초대 링크 처리 페이지 /join/[inviteCode]]
  - 비인증 사용자: 모임 기본 정보(제목, 날짜, 장소) 미리보기
  - "참여 신청하기" 버튼 클릭
  |
  | 미로그인 상태
  v
[로그인 페이지] - 로그인 후 원래 초대 링크로 자동 복귀
  |
  | 로그인 성공 → 초대코드로 참여 신청 자동 처리
  v
[모임 홈 페이지] - 참여 신청 완료 (pending 상태)
  |
  | 주최자 승인 후
  v
[모임 홈 페이지] - 승인 상태로 갱신
  - 핀 공지 확인
  - 공지 목록 조회
  - (Phase 2) 카풀 신청, 정산 내역 확인
```

### 4-3. 카풀 여정 (Phase 2)

```
[모임 홈 페이지]
  |
  | "카풀" 탭 클릭
  v
[카풀 페이지]
  |
  +--[드라이버]-------------------------------+
  | "카풀 제공 등록" 버튼 클릭                |
  | 출발지, 출발 시각, 탑승 가능 인원 입력   |
  | 등록 완료 → 카풀 목록에 표시             |
  |                                           |
  +--[탑승자]-------------------------------+
  | 카풀 목록에서 원하는 카풀 선택           |
  | "탑승 신청" 버튼 클릭                    |
  | 드라이버 수락/거절 대기                  |
  +------------------------------------------+
```

### 4-4. 정산 여정 (Phase 2)

```
[모임 홈 페이지]
  |
  | "정산" 탭 클릭 (주최자)
  v
[정산 페이지]
  |
  | "정산 항목 추가" 버튼 클릭
  v
  - 항목명, 총 금액 입력
  - 분할 방식 선택: 1/n 균등 or 수동 입력
  - "등록" 버튼 클릭 → 개인별 부담 금액 자동 계산
  |
  | 참여자 입장에서
  v
[정산 페이지]
  - 내 부담 금액 표시
  - 입금 계좌 정보 표시 (events.bank_account)
  - 주최자가 입금 확인 체크 → 입금 완료 표시
```

---

## 5. 기술 요구사항

### 기술 스택

**기존 구현 기반 (변경 없음)**

| 항목          | 기술                        | 비고                  |
| ------------- | --------------------------- | --------------------- |
| 프레임워크    | Next.js 16+ (App Router)    | Server Component 우선 |
| 언어          | TypeScript 5                | strict 모드           |
| UI 라이브러리 | React 19                    | Concurrent 기능 활용  |
| 스타일링      | Tailwind CSS v3 + shadcn/ui | CSS 변수 기반 테마    |
| 아이콘        | lucide-react                |                       |
| 테마          | next-themes                 | 라이트/다크 모드      |
| 인증          | Supabase Auth               | 이메일 + Google OAuth |
| 데이터베이스  | Supabase (PostgreSQL)       | RLS 기반 보안         |
| 배포          | Vercel                      | Next.js 최적화        |

**Phase 1 신규 추가 의존성**

```bash
npm install react-hook-form zod @hookform/resolvers
npm install date-fns
```

| 패키지              | 용도                         |
| ------------------- | ---------------------------- |
| react-hook-form 7.x | 모임 생성, 공지 작성 폼 관리 |
| zod                 | 폼 입력값 스키마 검증        |
| date-fns            | 날짜 포맷, 상대 시간 표시    |

### 페이지 구조

```
app/
├── page.tsx                                 # 랜딩 페이지
├── (auth)/
│   ├── login/page.tsx                       # 로그인
│   └── sign-up/page.tsx                     # 회원가입
├── protected/
│   └── events/
│       ├── page.tsx                         # 내 이벤트 페이지 (모바일 최적화)
│       ├── new/page.tsx                     # 모임 생성
│       └── [eventId]/
│           ├── page.tsx                     # 모임 홈
│           ├── members/page.tsx             # 참여자 관리 (Phase 1)
│           ├── announcements/
│           │   ├── page.tsx                 # 공지 목록 (Phase 1)
│           │   └── new/page.tsx             # 공지 작성 (Phase 1)
│           ├── carpool/page.tsx             # 카풀 (Phase 2)
│           └── expense/page.tsx             # 정산 (Phase 2)
└── join/
    └── [inviteCode]/page.tsx                # 초대 링크 처리 (비인증 허용)
```

### 인증 및 권한

**라우트 보호**

- `app/protected/**`: 기존 proxy.ts 패턴으로 미인증 시 로그인 페이지 리디렉션
- `app/join/[inviteCode]`: 비인증 접근 허용, 로그인 후 원래 URL로 복귀

**데이터 접근 권한 (RLS 정책)**

| 테이블           | 읽기                          | 쓰기                               |
| ---------------- | ----------------------------- | ---------------------------------- |
| events           | 승인된 참여자, 주최자         | 주최자만                           |
| event_members    | 해당 모임 주최자, 본인 레코드 | 본인 신청/탈퇴, 주최자 상태 변경   |
| announcements    | 승인된 참여자, 주최자         | 주최자만                           |
| carpool_offers   | 승인된 참여자                 | 본인 등록, 주최자 삭제             |
| carpool_requests | 해당 offer 드라이버, 본인     | 본인 신청, 드라이버 수락/거절      |
| expense_items    | 승인된 참여자                 | 주최자만                           |
| expense_splits   | 본인 레코드                   | 주최자(입금확인), 시스템 자동 생성 |

### 핵심 구현 패턴

**서버 컴포넌트 우선**

```tsx
// app/protected/events/[eventId]/page.tsx
import { createClient } from "@/lib/supabase/server";

export default async function EventHomePage({
  params,
}: {
  params: Promise<{ eventId: string }>;
}) {
  const { eventId } = await params;
  const supabase = await createClient();

  // 서버에서 데이터 패칭 (RLS 자동 적용)
  const { data: event } = await supabase
    .from("events")
    .select("*, announcements(*, is_pinned.eq.true)")
    .eq("id", eventId)
    .single();

  return <EventHome event={event} />;
}
```

**초대 링크 처리 패턴**

```tsx
// app/join/[inviteCode]/page.tsx
// 1. 미인증 사용자: 모임 정보 표시 + 로그인 유도
// 2. 인증 사용자: 즉시 참여 신청 처리 후 모임 홈으로 리디렉션
// 3. 이미 신청한 경우: 현재 상태 표시
```

**정산 자동 계산 패턴 (Phase 2)**

```
equal 분할:
  개인 부담 = ceil(total_amount / 승인된 참여자 수)
  나머지 금액 처리: 마지막 1명에서 차감

manual 분할:
  주최자가 각 참여자별 금액 직접 입력
  합계 검증: sum(splits.amount) === total_amount
```

---

## 6. 성공 지표

### 정성적 지표

- 주최자가 모임 생성 후 참여자 초대까지 5분 이내 완료
- 참여자가 초대 링크 클릭 후 참여 신청까지 3분 이내 완료
- 카카오톡에서 참여 의사를 직접 묻는 메시지 발송 0건
- 스프레드시트 병행 사용 중단

### 정량적 지표 (Phase 1 완료 후 4주 기준)

| 지표                          | 목표                        |
| ----------------------------- | --------------------------- |
| 생성된 모임 수                | 10개 이상                   |
| 모임당 평균 참여자 수         | 8명 이상                    |
| 초대 링크 통한 참여 신청 비율 | 전체 참여자의 80% 이상      |
| 주최자 재사용률               | 2회 이상 모임 생성 비율 60% |

---

## 7. 개발 로드맵

### Phase 1: 공지 + 참여자 관리 (4~5주)

**목표**: 카카오톡 + 스프레드시트 대체 가능한 최소 기능

#### Week 1: DB 셋업 + 모임 생성

- [ ] Supabase에 `events`, `event_members` 테이블 생성
- [ ] RLS 정책 설정 (events, event_members)
- [ ] `types/database.ts` 재생성 (`npx supabase gen types typescript`)
- [ ] 편의 타입 추가 (`Event`, `EventMember` 등)
- [ ] 모임 생성 페이지 구현 (react-hook-form + zod)
- [ ] 모임 목록 페이지 구현 (주최/참여 탭)

#### Week 2: 초대 링크 + 참여자 관리

- [ ] 초대 링크 처리 페이지 구현 (`/join/[inviteCode]`)
  - 비인증 사용자 모임 정보 미리보기
  - 로그인 후 자동 참여 신청 처리 (URL 상태 보존)
- [ ] 참여자 관리 페이지 구현
  - 상태별 필터 (대기/승인/거절)
  - 승인/거절/탈퇴 처리 버튼
  - 모임 마감 기능

#### Week 3: 공지 기능 + 모임 홈

- [ ] `announcements` 테이블 생성 및 RLS 설정
- [ ] 공지 목록 페이지 구현 (핀 공지 상단 고정)
- [ ] 공지 작성 페이지 구현 (주최자 전용)
- [ ] 모임 홈 페이지 통합
  - 핀 공지 요약 표시
  - 기본 정보 + 인원 현황
  - 초대 링크 복사 버튼

#### Week 4~5: 마무리 + QA

- [ ] 에러 핸들링 및 로딩 상태 처리 (Suspense + Skeleton)
- [ ] 모바일 반응형 UI 검토
- [ ] 엣지 케이스 처리 (마감된 모임, 이미 신청한 경우, 정원 초과)
- [ ] 실 사용 테스트 (주최자 시나리오 직접 실행)

#### Phase 1 완료 기준

- 주최자가 모임 생성 → 초대 링크 공유 → 참여자 승인 전체 흐름 정상 동작
- 공지 작성 및 핀 고정 정상 동작
- 초대 링크로 비인증 사용자 진입 후 로그인 → 자동 참여 신청 정상 동작

---

### Phase 2: 카풀 + 정산 (3~4주)

**목표**: 모임 당일 운영(카풀 조율)과 사후 정산(금액 계산 + 계좌 안내) 자동화

#### Week 1~2: 카풀 기능

- [ ] `carpool_offers`, `carpool_requests` 테이블 생성 및 RLS 설정
- [ ] 카풀 페이지 구현
  - 카풀 제공 목록 표시 (출발지, 출발 시각, 잔여 좌석)
  - 카풀 제공 등록 폼
  - 탑승 신청 및 드라이버 수락/거절
- [ ] types/database.ts 업데이트

#### Week 3~4: 정산 기능

- [ ] `expense_items`, `expense_splits` 테이블 생성 및 RLS 설정
- [ ] 정산 페이지 구현
  - 정산 항목 등록 (균등/수동 분할)
  - 개인별 부담 금액 자동 계산
  - 계좌 정보 표시 (events.bank_account 연동)
  - 주최자 입금 확인 체크

#### Phase 2 완료 기준

- 드라이버가 카풀 등록 → 탑승자 신청 → 드라이버 수락 전체 흐름 정상 동작
- 주최자가 정산 항목 등록 시 참여자별 부담 금액 자동 계산 정상 동작
- 참여자가 정산 페이지에서 자신의 금액과 계좌 정보 확인 가능

---

## 참고: 기존 구현 현황

Phase 1 개발 전 이미 완료된 기반 작업:

| 항목                       | 상태 | 위치             |
| -------------------------- | ---- | ---------------- |
| 이메일/비밀번호 인증       | 완료 | `app/(auth)/`    |
| Google OAuth               | 완료 | `app/(auth)/`    |
| 라우트 보호 (proxy.ts)     | 완료 | `proxy.ts`       |
| Suspense + Skeleton 패턴   | 완료 | `app/protected/` |
| Server Component 우선 구조 | 완료 | 전체             |
| shadcn/ui 컴포넌트 기반    | 완료 | `components/ui/` |
| Prettier + ESLint + Husky  | 완료 | 루트 설정 파일   |

---

_최종 수정: 2026-02-22_
